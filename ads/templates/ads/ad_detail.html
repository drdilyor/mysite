{% extends 'ads/base_navbar.html' %}

{% load humanize %}
{% load materializecss %}
{% block title %}{{ ad }} detail {% endblock %}

{% block css %}
{{ block.super }}
<style>
.align-down {
  display: flex;
  align-items: bottom;
}
.fill-width {
  width: 100%;
  height: auto;
}
.responsive:not(.active) {
  /* not .active to display correctly when lightboxed */
  max-width: 100%;
  height: auto;
}
.flex { display: flex; }
.reverse { flex-direction: row-reverse; }
.flex-1 { flex: 1; }
.img-container { max-width: 40%; }
@media screen and (max-width: 599.8px) {
  .column-on-small { flex-direction: column; }
  .img-container {
    max-width: 100%;
    width: 100%;
    display: flex;
    justify-content: center;
  }
}

</style>
{% endblock css %}
{% block js %}
{{ block.super }}
<script>
$(document).ready(function() {
  $('.materialboxed').materialbox()
})
</script>
{% endblock js %}

{% block content %}
{{ block.super }}
<div class="container">
  <h1 class="">{{ ad.title }}</h1>
  <div class="flex reverse column-on-small">
    {% if ad.content_type %}
    <!-- please explain me how does this work -->
    <div class="img-container">
        <img class="materialboxed responsive" src="{% url 'ads:ad_picture' ad.id %}">
    </div>
    {% endif %}

    <div class="flex-1">
      {{ ad.text|linebreaks }}
      <p>Price: ${{ ad.price }}</p>
      <a class="btn-flat waves-effect" href="{% url 'ads:update' ad.id %}">
        <i class="material-icons">edit</i></a>
      <a class="btn-flat waves-effect" href="{% url 'ads:delete' ad.id %}">
        <i class="material-icons">delete</i></a>
    </div>
  </div>
  <form action="comment" method="post">
    {% csrf_token %}
    {{ comment_form|materializecss }}
    <button type="submit" class="btn waves-effect waves-light">Submit</button>
    <a class="btn-flat waves-effect" href="{% url 'ads:index' %}">Back to ads</a>
  </form>
  {% for comment in comments %}
  <p class="align-down">
    <span>{{ comment.text }} ({{ comment.created_at|naturaltime }})</span>
      {% if comment.owner == request.user %}
      <a href="{% url 'ads:comment_delete' comment.id %}"><i class="material-icons">delete</i></a>
      {% endif %}
  </p>
  {% endfor %}
  </div>
</div>

{% endblock content %}

